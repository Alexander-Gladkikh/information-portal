"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[676],{8791:function(e,a,n){n.d(a,{I:function(){return l}});var r=n(7294),s=n(3007),t=n(5893);const l=(0,r.memo)((e=>{const{className:a,value:n,onChange:l,type:o="text",placeholder:i,autofocus:d,readonly:c,...u}=e,h=(0,r.useRef)(null),[x,g]=(0,r.useState)(!1),[p,m]=(0,r.useState)(0),C=x&&!c;(0,r.useEffect)((()=>{d&&(g(!0),h.current?.focus())}),[d]);const f={sFcbjx23:c};return(0,t.jsxs)("div",{className:(0,s.A)("p_6dRLUG",f,[a]),children:[i&&(0,t.jsx)("div",{className:"uWIRRz2O",children:`${i}>`}),(0,t.jsxs)("div",{className:"tDY7ayAp",children:[(0,t.jsx)("input",{ref:h,type:o,value:n,onChange:e=>{l?.(e.target.value),m(e.target.value.length)},className:"Z6IBiNl_",onFocus:()=>{g(!0)},onBlur:()=>{g(!1)},onSelect:e=>{m(e?.target?.selectionStart||0)},readOnly:c,...u}),C&&(0,t.jsx)("span",{className:"Y3U88xm_",style:{left:9*p+"px"}})]})]})}))},169:function(e,a,n){n.d(a,{I:function(){return d}});var r=n(7294),s=n(3007),t={InputWrapper:"ZyI7rxIe",s:"mKldd7L_",m:"IyQiG8hL",l:"j7JcqtN4",addonLeft:"OqwwYwm8",addonRight:"o_xLYaZC",withAddonLeft:"zVArqqw4",withAddonRight:"HxXya_r8",input:"L2BiQ3jT",focused:"jUzuVRdk",readonly:"xspqW3a0"},l=n(9244),o=n(8969),i=n(5893);const d=(0,r.memo)((e=>{const{className:a,value:n,onChange:d,type:c="text",placeholder:u,autofocus:h,readonly:x,addonLeft:g,addonRight:p,label:m,size:C="m",...f}=e,j=(0,r.useRef)(null),[R,y]=(0,r.useState)(!1);(0,r.useEffect)((()=>{h&&(y(!0),j.current?.focus())}),[h]);const v={[t.readonly]:x,[t.focused]:R,[t.withAddonLeft]:Boolean(g),[t.withAddonRight]:Boolean(p)},N=(0,i.jsxs)("div",{className:(0,s.A)(t.InputWrapper,v,[a,t[C]]),children:[(0,i.jsx)("div",{className:t.addonLeft,children:g}),(0,i.jsx)("input",{ref:j,type:c,value:n,onChange:e=>{d?.(e.target.value)},className:t.input,onFocus:()=>{y(!0)},onBlur:()=>{y(!1)},placeholder:u,readOnly:x,...f}),(0,i.jsx)("div",{className:t.addonRight,children:p})]});return m?(0,i.jsxs)(l.U,{max:!0,gap:"8",children:[(0,i.jsx)(o.x,{text:m}),N]}):N}))},2676:function(e,a,n){n.r(a),n.d(a,{default:function(){return le}});var r=n(7294),s=n(9250),t=n(3007),l=n(3831),o=n(9244),i=n(2327),d=n(743),c=n(5401),u=n(9970),h=n(526),x=n(7499),g={ProfileCard:"QTLlYN1L",loading:"TX39V40k",error:"bA_iT2GX",editing:"FmG40szU"},p=n(9085),m=n(8791);let C=function(e){return e.RUB="RUB",e.EUR="EUR",e.USD="USD",e}({});var f=n(3355),j=n(9248),R=n(5893);const y=[{value:C.RUB,content:C.RUB},{value:C.EUR,content:C.EUR},{value:C.USD,content:C.USD}],v=(0,r.memo)((e=>{let{className:a,value:n,onChange:s,readonly:t}=e;const{t:l}=(0,i.$)(),o=(0,r.useCallback)((e=>{s?.(e)}),[s]),d={className:a,value:n,defaultValue:l("Укажите валюту"),label:l("Укажите валюту"),items:y,onChange:o,readonly:t,direction:"top right"};return(0,R.jsx)(x.zJ,{features:"isAppRedesigned",on:(0,R.jsx)(j.wb,{...d}),off:(0,R.jsx)(f.wb,{...d})})}));let N=function(e){return e.Russia="Russia",e.Belarus="Belarus",e.Kazakhstan="Kazakhstan",e.Arminia="Arminia",e}({});const E=[{value:N.Arminia,content:N.Arminia},{value:N.Russia,content:N.Russia},{value:N.Belarus,content:N.Belarus},{value:N.Kazakhstan,content:N.Kazakhstan}],A=(0,r.memo)((e=>{let{className:a,value:n,onChange:s,readonly:t}=e;const{t:l}=(0,i.$)(),o=(0,r.useCallback)((e=>{s?.(e)}),[s]),d={className:a,onChange:o,value:n,defaultValue:l("Укажите страну"),label:l("Укажите страну"),items:E,readonly:t,direction:"top right"};return(0,R.jsx)(x.zJ,{features:"isAppRedesigned",on:(0,R.jsx)(j.wb,{...d}),off:(0,R.jsx)(f.wb,{...d})})}));var O=n(7953);const U=()=>{const{t:e}=(0,i.$)();return(0,R.jsx)(o.U,{justify:"center",max:!0,className:(0,t.A)(g.ProfileCard,{},[g.error]),children:(0,R.jsx)(h.xv,{theme:h.lg.ERROR,title:e("Произошла ошибка при загрузке профиля"),text:e("Попробуйте обновить страницу"),align:h.PH.CENTER})})};U.displayName="ProfileCardDeprecatedError";const b=()=>(0,R.jsx)(o.U,{justify:"center",max:!0,className:(0,t.A)(g.ProfileCard,{[g.loading]:!0}),children:(0,R.jsx)(O.a,{})});b.displayName="ProfileCardDeprecatedLoader";const I=(0,r.memo)((e=>{const{className:a,data:n,readonly:r,onChangeFirstname:s,onChangeLastname:l,onChangeAge:d,onChangeCity:c,onChangeAvatar:u,onChangeUsername:h,onChangeCountry:x,onChangeCurrency:C}=e,{t:f}=(0,i.$)("profile"),j={[g.editing]:!r};return(0,R.jsxs)(o.g,{gap:"8",max:!0,className:(0,t.A)(g.ProfileCard,j,[a]),children:[n?.avatar&&(0,R.jsx)(o.U,{justify:"center",max:!0,className:g.avatarWrapper,children:(0,R.jsx)(p.q,{src:n?.avatar})}),(0,R.jsx)(m.I,{value:n?.first,placeholder:f("Ваше имя"),className:g.input,onChange:s,readonly:r}),(0,R.jsx)(m.I,{value:n?.lastname,placeholder:f("Ваша фамилия"),className:g.input,onChange:l,readonly:r}),(0,R.jsx)(m.I,{value:n?.age,placeholder:f("Ваш возраст"),className:g.input,onChange:d,readonly:r}),(0,R.jsx)(m.I,{value:n?.city,placeholder:f("Город"),className:g.input,onChange:c,readonly:r}),(0,R.jsx)(m.I,{value:n?.username,placeholder:f("Введите имя пользователя"),className:g.input,onChange:h,readonly:r}),(0,R.jsx)(m.I,{value:n?.avatar,placeholder:f("Введите ссылку на аватар"),className:g.input,onChange:u,readonly:r}),(0,R.jsx)(v,{className:g.input,value:n?.currency,onChange:C,readonly:r}),(0,R.jsx)(A,{className:g.input,value:n?.country,onChange:x,readonly:r})]})}));var T=n(7231),_=n(7184),w=n(169),k=n(6265),L=n(8969);const P=()=>{const{t:e}=(0,i.$)();return(0,R.jsx)(o.U,{justify:"center",max:!0,children:(0,R.jsx)(L.x,{variant:"error",title:e("Произошла ошибка при загрузке профиля"),text:e("Попробуйте обновить страницу"),align:"center"})})};P.displayName="ProfileCardRedesignedError";const z=()=>(0,R.jsx)(T.Z,{padding:"24",max:!0,children:(0,R.jsxs)(o.g,{gap:"32",children:[(0,R.jsx)(o.U,{max:!0,justify:"center",children:(0,R.jsx)(k.O,{border:"100%",width:128,height:128})}),(0,R.jsxs)(o.U,{gap:"32",max:!0,children:[(0,R.jsxs)(o.g,{gap:"16",max:!0,children:[(0,R.jsx)(k.O,{width:"100%",height:38}),(0,R.jsx)(k.O,{width:"100%",height:38}),(0,R.jsx)(k.O,{width:"100%",height:38}),(0,R.jsx)(k.O,{width:"100%",height:38})]}),(0,R.jsxs)(o.g,{gap:"16",max:!0,children:[(0,R.jsx)(k.O,{width:"100%",height:38}),(0,R.jsx)(k.O,{width:"100%",height:38}),(0,R.jsx)(k.O,{width:"100%",height:38}),(0,R.jsx)(k.O,{width:"100%",height:38})]})]})]})});z.displayName="ProfileCardRedesignedSkeleton";const S=(0,r.memo)((e=>{const{className:a,data:n,readonly:r,onChangeFirstname:s,onChangeLastname:t,onChangeAge:l,onChangeCity:d,onChangeAvatar:c,onChangeUsername:u,onChangeCountry:h,onChangeCurrency:x}=e,{t:g}=(0,i.$)("profile");return(0,R.jsx)(T.Z,{padding:"24",border:"partial",max:!0,className:a,children:(0,R.jsxs)(o.g,{gap:"32",children:[n?.avatar&&(0,R.jsx)(o.U,{justify:"center",max:!0,children:(0,R.jsx)(_.q,{size:128,src:n?.avatar})}),(0,R.jsxs)(o.U,{gap:"24",max:!0,children:[(0,R.jsxs)(o.g,{gap:"16",max:!0,children:[(0,R.jsx)(w.I,{value:n?.first,label:g("Имя"),onChange:s,readonly:r}),(0,R.jsx)(w.I,{value:n?.lastname,label:g("Фамилия"),onChange:t,readonly:r}),(0,R.jsx)(w.I,{value:n?.age,label:g("Возраст"),onChange:l,readonly:r}),(0,R.jsx)(w.I,{value:n?.city,label:g("Город"),onChange:d,readonly:r})]}),(0,R.jsxs)(o.g,{gap:"16",max:!0,children:[(0,R.jsx)(w.I,{value:n?.username,label:g("Имя пользователя"),onChange:u,readonly:r}),(0,R.jsx)(w.I,{value:n?.avatar,label:g("Cсылка на аватар"),onChange:c,readonly:r}),(0,R.jsx)(v,{value:n?.currency,onChange:x,readonly:r}),(0,R.jsx)(A,{value:n?.country,onChange:h,readonly:r})]})]})]})})})),D=e=>{const{isLoading:a,error:n}=e,{t:r}=(0,i.$)();return a?(0,R.jsx)(x.zJ,{features:"isAppRedesigned",on:(0,R.jsx)(z,{}),off:(0,R.jsx)(b,{})}):n?(0,R.jsx)(x.zJ,{features:"isAppRedesigned",on:(0,R.jsx)(P,{}),off:(0,R.jsx)(U,{})}):(0,R.jsx)(x.zJ,{features:"isAppRedesigned",on:(0,R.jsx)(S,{...e}),off:(0,R.jsx)(I,{...e})})};D.displayName="ProfileCard";var B=n(1233);let $=function(e){return e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR",e}({});const V=e=>e.profile?.form,Y=e=>e.profile?.isLoading,W=e=>e.profile?.error,F=e=>e.profile?.readonly,G=e=>e.profile?.validateErrors;var q=n(4268);const J=(0,q.hg)("profile/fetchProfileData",(async(e,a)=>{const{extra:n,rejectWithValue:r}=a;try{const a=await n.api.get(`/profile/${e}`);if(!a.data)throw new Error;return a.data}catch(e){return console.log(e),r("error")}})),Z=(0,q.hg)("profile/updateProfileData",(async(e,a)=>{const{extra:n,rejectWithValue:r,getState:s}=a,t=V(s()),l=(e=>{if(!e)return[$.NO_DATA];const{first:a,lastname:n,age:r,country:s}=e,t=[];return a&&n||t.push($.INCORRECT_USER_DATA),r&&Number.isInteger(r)||t.push($.INCORRECT_AGE),s||t.push($.INCORRECT_COUNTRY),t})(t);if(l.length)return r(l);try{const e=await n.api.put(`/profile/${t?.id}`,t);if(!e.data)throw new Error;return e.data}catch(e){return console.log(e),r([$.SERVER_ERROR])}})),K=(0,q.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:(e,a)=>{e.readonly=a.payload},cancelEdit:e=>{e.readonly=!0,e.validateErrors=void 0,e.form=e.data},updateProfile:(e,a)=>{e.form={...e.data,...a.payload}}},extraReducers:e=>{e.addCase(J.pending,(e=>{e.error=void 0,e.isLoading=!0})).addCase(J.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload})).addCase(J.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload})).addCase(Z.pending,(e=>{e.validateErrors=void 0,e.isLoading=!0})).addCase(Z.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(Z.rejected,((e,a)=>{e.isLoading=!1,e.validateErrors=a.payload}))}}),{actions:M}=K,{reducer:Q}=K;var X=n(7702),H=n(3733);const ee=e=>e.profile?.data;var ae=n(8190);const ne=(0,r.memo)((e=>{const{className:a}=e,{t:n}=(0,i.$)("profile"),s=(0,d.v9)(H.m5),l=(0,d.v9)(ee),u=s?.id===l?.id,g=(0,d.v9)(F),p=(0,c.T)(),m=(0,r.useCallback)((()=>{p(M.setReadonly(!1))}),[p]),C=(0,r.useCallback)((()=>{p(M.cancelEdit())}),[p]),f=(0,r.useCallback)((()=>{p(Z())}),[p]);return(0,R.jsx)(x.zJ,{features:"isAppRedesigned",on:(0,R.jsx)(T.Z,{padding:"24",max:!0,border:"partial",children:(0,R.jsxs)(o.U,{max:!0,justify:"between",className:(0,t.A)("",{},[a]),children:[(0,R.jsx)(L.x,{title:n("Профиль")}),u&&(0,R.jsx)("div",{children:g?(0,R.jsx)(ae.z,{onClick:m,children:n("Редактировать")}):(0,R.jsxs)(o.U,{gap:"8",children:[(0,R.jsx)(ae.z,{onClick:C,color:"error",children:n("Отменить")}),(0,R.jsx)(ae.z,{onClick:f,color:"success",children:n("Сохранить")})]})})]})}),off:(0,R.jsxs)(o.U,{max:!0,justify:"between",className:(0,t.A)("",{},[a]),children:[(0,R.jsx)(h.xv,{title:n("Профиль")}),u&&(0,R.jsx)("div",{children:g?(0,R.jsx)(X.zx,{theme:X.bn.OUTLINE,onClick:m,children:n("Редактировать")}):(0,R.jsxs)(o.U,{gap:"8",children:[(0,R.jsx)(X.zx,{theme:X.bn.OUTLINE_RED,onClick:C,children:n("Отменить")}),(0,R.jsx)(X.zx,{theme:X.bn.OUTLINE,onClick:f,children:n("Сохранить")})]})})]})})})),re={profile:Q},se=(0,r.memo)((e=>{const{className:a,id:n}=e,{t:s}=(0,i.$)("profile"),l=(0,c.T)(),x=(0,d.v9)(V),g=(0,d.v9)(Y),p=(0,d.v9)(W),m=(0,d.v9)(F),C=(0,d.v9)(G),f={[$.SERVER_ERROR]:s("Серверная ошибка при сохранении"),[$.INCORRECT_COUNTRY]:s("Некорректный регион"),[$.NO_DATA]:s("Данные не указаны"),[$.INCORRECT_USER_DATA]:s("Имя и фамилия обязательны"),[$.INCORRECT_AGE]:s("Некорректный возраст")};(0,u.Q)((()=>{n&&l(J(n))}));const j=(0,r.useCallback)((e=>{l(M.updateProfile({first:e||""}))}),[l]),y=(0,r.useCallback)((e=>{l(M.updateProfile({lastname:e||""}))}),[l]),v=(0,r.useCallback)((e=>{l(M.updateProfile({city:e||""}))}),[l]),N=(0,r.useCallback)((e=>{l(M.updateProfile({age:Number(e||0)}))}),[l]),E=(0,r.useCallback)((e=>{l(M.updateProfile({username:e||""}))}),[l]),A=(0,r.useCallback)((e=>{l(M.updateProfile({avatar:e||""}))}),[l]),O=(0,r.useCallback)((e=>{l(M.updateProfile({currency:e}))}),[l]),U=(0,r.useCallback)((e=>{l(M.updateProfile({country:e}))}),[l]);return(0,R.jsx)(B.W,{reducers:re,children:(0,R.jsxs)(o.g,{gap:"16",max:!0,className:(0,t.A)("",{},[a]),children:[(0,R.jsx)(ne,{}),C?.length&&C.map((e=>(0,R.jsx)(h.xv,{theme:h.lg.ERROR,text:f[e]},e))),(0,R.jsx)(D,{data:x,isLoading:g,error:p,readonly:m,onChangeFirstname:j,onChangeLastname:y,onChangeAge:N,onChangeCity:v,onChangeUsername:E,onChangeAvatar:A,onChangeCurrency:O,onChangeCountry:U})]})})})),te=e=>{let{className:a}=e;const{id:n}=(0,s.UO)();return(0,R.jsx)(o.U,{max:!0,justify:"center",children:(0,R.jsx)(l.T,{className:(0,t.A)("",{},[a]),children:(0,R.jsx)(o.g,{gap:"16",max:!0,children:(0,R.jsx)(se,{id:n})})})})};te.displayName="ProfilePage";var le=(0,r.memo)(te)},1233:function(e,a,n){n.d(a,{W:function(){return l}});var r=n(7294),s=n(743),t=n(5893);const l=e=>{const{children:a,reducers:n,removeAfterUnmount:l=!0}=e,o=(0,s.oR)(),i=(0,s.I0)();return(0,r.useEffect)((()=>{const e=o.reducerManager.getMountedReducers();return Object.entries(n).forEach((a=>{let[n,r]=a;e[n]||(o.reducerManager.add(n,r),i({type:`@INIT ${n} reducer`}))})),()=>{l&&Object.entries(n).forEach((e=>{let[a,n]=e;o.reducerManager.remove(a),i({type:`@DESTROY ${a} reducer`})}))}}),[]),(0,t.jsx)(t.Fragment,{children:a})}}}]);